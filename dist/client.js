(()=>{let e;var t={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let n=new Uint8Array(16),l=[];for(let e=0;e<256;++e)l.push((e+256).toString(16).slice(1));var i=function(i,r,o){if(t.randomUUID&&!r&&!i)return t.randomUUID();let s=(i=i||{}).random||(i.rng||function(){if(!e&&!(e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(n)})();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,r){o=o||0;for(let e=0;e<16;++e)r[o+e]=s[e];return r}return function(e,t=0){return l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]}(s)};let r="dirty-elements";class o extends HTMLElement{constructor(){super(),this.boundBeforeUnloadHandler=this.handleBeforeUnload.bind(this)}static get observedAttributes(){return["dirty-elements"]}attributeChangedCallback(e,t,n){"dirty-elements"===e&&(n?this.triggerBeforeUnload():this.removeBeforeUnload())}triggerBeforeUnload(){window.onbeforeunload||(window.onbeforeunload=this.boundBeforeUnloadHandler)}removeBeforeUnload(){window.onbeforeunload&&(window.onbeforeunload=null)}handleBeforeUnload(e){e.preventDefault(),e.returnValue=""}}window.customElements.define("unload-handler",o);class s extends HTMLElement{constructor(){if(super(),!this.shadowRoot)throw Error("Declarative shadow root not supported");let e=this.shadowRoot.querySelector("slot");if(!(e instanceof HTMLSlotElement))throw Error("No slot element provided");let t=e.assignedNodes();if(!t||!t.length)throw Error("No content provided");let n=t.find(function(e){return e instanceof HTMLInputElement});if(!n)throw Error("No input element provided");let l=window.document.querySelector("unload-handler");if(!(l instanceof HTMLElement))throw Error("No unload handler element found");this.inputElement=n,this.inputId=n.id||"".concat(Date.now(),"-").concat(i()),this.unloadHandlerElement=l,this.boundChangeHandler=this.handleChange.bind(this),this.boundInputHandler=this.handleInput.bind(this)}handleChange(){}handleInput(){}markDirty(){let e=this.unloadHandlerElement.getAttribute(r)||"",t=e?e.split(","):[];t.push(this.inputId);let n=Array.from(new Set(t)).join(",");this.unloadHandlerElement.setAttribute(r,n),this.inputElement.setAttribute("data-dirty","")}markClean(){let e=this.unloadHandlerElement.getAttribute(r)||"",t=(e?e.split(","):[]).filter(e=>e!==this.inputId).join(",");this.unloadHandlerElement.setAttribute(r,t),this.inputElement.removeAttribute("data-dirty"),this.inputElement.setAttribute("value",this.inputElement.value)}async patch(e,t){let n=new FormData;return n.append("_method","PATCH"),n.append(this.inputElement.name,t),window.fetch(e,{method:"POST",body:n}).then(e=>{if(404===e.status)throw Error("Not found");return e})}}window.customElements.define("auto-save-text",class extends s{constructor(){super(...arguments),this.boundKeydownHandler=this.handleKeydown.bind(this),this.boundClickHandler=this.handleClick.bind(this),this.boundBlurHandler=this.handleBlur.bind(this)}connectedCallback(){this.inputElement.addEventListener("change",this.boundChangeHandler),this.inputElement.addEventListener("keydown",this.boundKeydownHandler),this.inputElement.addEventListener("blur",this.boundBlurHandler),this.inputElement.addEventListener("pointerup",this.boundClickHandler)}disconnectedCallback(){this.inputElement.removeEventListener("change",this.boundChangeHandler),this.inputElement.removeEventListener("keydown",this.boundKeydownHandler),this.inputElement.removeEventListener("blur",this.boundBlurHandler),this.inputElement.removeEventListener("pointerup",this.boundClickHandler)}enterEditMode(){this.inputElement.removeAttribute("data-read-only")}exitEditMode(){this.inputElement.setAttribute("data-read-only",""),this.inputElement.value!==this.inputElement.getAttribute("value")&&this.submitData().then(()=>{this.markClean()})}toggleEditMode(){""===this.inputElement.dataset.readOnly?this.enterEditMode():this.exitEditMode()}handleClick(){this.enterEditMode()}handleBlur(){this.exitEditMode()}handleKeydown(e){e instanceof KeyboardEvent&&("Escape"===e.key&&""!==this.inputElement.dataset.readOnly&&this.exitEditMode(),"Enter"===e.key&&(e.preventDefault(),this.toggleEditMode(),""===this.inputElement.dataset.readOnly?(this.dispatchEvent(new CustomEvent("auto-save-text:toggle-edit-mode",{composed:!0,bubbles:!0})),this.submitData().then(()=>{this.dispatchEvent(new CustomEvent("auto-save-text:save",{composed:!0,bubbles:!0}))})):this.inputElement.selectionStart=this.inputElement.selectionEnd=this.inputElement.value.length),1===e.key.length&&/[a-zA-Z0-9-_ ]/.test(e.key)&&""===this.inputElement.dataset.readOnly&&(this.toggleEditMode(),this.inputElement.value="",this.inputElement.selectionStart=this.inputElement.selectionEnd=this.inputElement.value.length))}async submitData(){let e=this.inputElement.value,t=this.inputElement.form;if(!t){this.markDirty();return}let n=t.getAttribute("action");if(n){if(["PUT","PATCH"].includes(new FormData(t).get("_method")?.toString()||""))return this.patch(n,e).then(()=>{this.inputElement.setAttribute("value",e),this.markClean()}).catch(()=>{this.markDirty()});this.markDirty()}}}),window.customElements.define("auto-save-checkbox",class extends s{constructor(){super(),this.boundMarkClean=this.markClean.bind(this);let e=this.inputElement.form;if(!e)return;this.formElement=e}connectedCallback(){this.inputElement.addEventListener("input",this.boundInputHandler),this.formElement&&this.formElement.addEventListener("submit",this.boundMarkClean)}disconnectedCallback(){this.inputElement.removeEventListener("input",this.boundInputHandler),this.formElement&&this.formElement.removeEventListener("submit",this.boundMarkClean)}handleInput(){let e=this.inputElement.checked?this.inputElement.value:"",t=this.inputElement.form;if(!t){this.markDirty();return}let n=t.getAttribute("action");n&&(["PUT","PATCH"].includes(new FormData(t).get("_method")?.toString()||"")?this.patch(n,e).then(()=>{window.location.reload()}).catch(()=>{this.markDirty()}):this.inputElement.checked!==this.inputElement.defaultChecked?this.markDirty():this.markClean())}});var a={};function d(e,t,n){function l(){var d=Date.now()-s;d<t&&d>=0?i=setTimeout(l,t-d):(i=null,n||(a=e.apply(o,r),o=r=null))}null==t&&(t=100);var i,r,o,s,a,d=function(){o=this,r=arguments,s=Date.now();var d=n&&!i;return i||(i=setTimeout(l,t)),d&&(a=e.apply(o,r),o=r=null),a};return d.clear=function(){i&&(clearTimeout(i),i=null)},d.flush=function(){i&&(a=e.apply(o,r),o=r=null,clearTimeout(i),i=null)},d}d.debounce=d,a=d,window.customElements.define("auto-save-search",class extends s{constructor(){var e;super(...arguments),this.debouncedInputHandler=((e=a)&&e.__esModule?e.default:e)(this.boundInputHandler,350)}connectedCallback(){this.inputElement.addEventListener("input",this.debouncedInputHandler)}disconnectedCallback(){this.inputElement.removeEventListener("input",this.debouncedInputHandler)}handleInput(){let e=this.inputElement.form;e&&e.submit()}});class h extends HTMLElement{constructor(){super(...arguments),this.boundClickHandler=this.handleClick.bind(this)}connectedCallback(){let e=this.querySelector("button");if(!(e instanceof HTMLButtonElement))throw Error("No button element provided");let t=e.form;if(!(t instanceof HTMLFormElement))throw Error("No form element provided");let n=Array.from(t.elements).find(function(e){return e instanceof HTMLInputElement&&"search"===e.type});if(!n)throw Error("No search input element provided");this.buttonElement=e,this.formElement=t,this.searchInputElement=n,this.buttonElement.addEventListener("click",this.boundClickHandler)}disconnectedCallback(){this.buttonElement&&this.buttonElement.removeEventListener("click",this.boundClickHandler)}handleClick(){if(!this.searchInputElement)throw Error("No search input element provided");if(!this.formElement)throw Error("No form element provided");this.searchInputElement.removeAttribute("name"),this.formElement.submit()}}window.customElements.define("clear-search",h);class c extends HTMLElement{constructor(){super(...arguments),this.boundSubmitHandler=this.handleFormSubmit.bind(this)}connectedCallback(){let e=this.querySelector("form");if(!(e instanceof HTMLFormElement))throw Error("PostFormElement must contain a form element");this.formElement=e,this.formElement.addEventListener("submit",this.boundSubmitHandler)}disconnectedCallback(){this.formElement&&this.formElement.removeEventListener("submit",this.boundSubmitHandler)}handleFormSubmit(e){if(e.preventDefault(),!this.formElement)return;let t=window.document.querySelector("unload-handler");if(!t)return;let n=t.getAttribute(r)||"",l=n?n.split(","):[],i=Array.from(this.formElement.elements),o=l.filter(e=>{let t=window.document.getElementById(e);return t&&!i.includes(t)}).join(",");t.setAttribute(r,o),this.formElement.submit()}}window.customElements.define("post-form",c);class m extends HTMLElement{constructor(){if(super(),this.boundChangeHandler=this.handleChange.bind(this),this.boundControllableCheckboxChangeHandler=this.handleControllableCheckboxChange.bind(this),!this.shadowRoot)throw Error("Declarative shadow root not supported");let e=this.querySelector("input");if(!(e instanceof HTMLInputElement))throw Error("No input element provided");let t=e.form;if(!t)throw Error("No form element provided");let n=e.getAttribute("name");this.checkboxElements=Array.from(t.elements).filter(function(e){return e instanceof HTMLInputElement&&"checkbox"===e.type&&e.name===n}),this.inputElement=e,this.formElement=t}connectedCallback(){for(let e of(this.inputElement.addEventListener("change",this.boundChangeHandler),this.checkboxElements))e.addEventListener("change",this.boundControllableCheckboxChangeHandler)}disconnectedCallback(){for(let e of(this.inputElement.removeEventListener("change",this.boundChangeHandler),this.checkboxElements))e.removeEventListener("change",this.boundControllableCheckboxChangeHandler)}handleChange(){let e=this.inputElement.checked;for(let t of this.checkboxElements)t.checked=e}handleControllableCheckboxChange(){let e=this.checkboxElements.every(e=>e.checked);this.inputElement.checked=e}}window.customElements.define("select-all-checkbox",m);class u extends HTMLElement{constructor(){super(),this.boundKeydownHandler=this.handleKeydown.bind(this);let e=this.querySelector("dialog");if(!(e instanceof HTMLDialogElement))throw Error("Could not find dialog element");this.dialogElement=e}connectedCallback(){this.addEventListener("keydown",this.boundKeydownHandler)}disconnectedCallback(){this.removeEventListener("keydown",this.boundKeydownHandler)}handleKeydown(e){if(e instanceof KeyboardEvent&&"Escape"===e.key){let e=this.dialogElement.querySelector("#close-dialog-button");e instanceof HTMLElement&&e.click()}}}window.customElements.define("modal-dialog",u);class E extends HTMLElement{constructor(){super(),this.boundKeydownHandler=this.handleKeydown.bind(this),this.boundToggleHandler=this.handleToggle.bind(this),this.boundFocusoutHandler=this.handleFocusout.bind(this);let e=this.querySelector("details");if(!(e instanceof HTMLDetailsElement))throw Error("Could not find details element");this.detailsElement=e;let t=this.querySelector("summary");if(!(t instanceof HTMLElement))throw Error("Could not find summary element");this.summaryElement=t;let n=this.querySelector('[role="menu"]');if(!(n instanceof HTMLElement))throw Error("Could not find menu element");let l=Array.from(n.querySelectorAll('[role="menuitem"]')).filter(function(e){return e instanceof HTMLElement});this.menuItemElements=l}connectedCallback(){this.addEventListener("keydown",this.boundKeydownHandler),this.addEventListener("focusout",this.boundFocusoutHandler),this.detailsElement.addEventListener("toggle",this.boundToggleHandler)}disconnectedCallback(){this.removeEventListener("keydown",this.boundKeydownHandler),this.removeEventListener("focusout",this.boundFocusoutHandler),this.detailsElement.removeEventListener("toggle",this.boundToggleHandler)}positionPopover(){let{left:e,top:t,height:n,width:l}=this.summaryElement.getBoundingClientRect(),i=e>window.innerWidth/2?`calc(-100% - ${l}px)`:"0px",r=t>window.innerHeight/2?`calc(-100% + ${n}px)`:"0px",o=`translateX(${i}) translateY(${r})`;this.style.setProperty("--popover-transform",o),this.style.setProperty("--popover-left",`${e+l}px`),this.style.setProperty("--popover-top",`${t}px`)}handleKeydown(e){if(!(e instanceof KeyboardEvent))return;if(!this.detailsElement.open){[" ","Enter"].includes(e.key)&&this.positionPopover();return}"Escape"===e.key&&(this.summaryElement.focus(),this.detailsElement.open=!1);let t=e.composedPath().find(e=>e instanceof HTMLElement&&e.matches('[role="menuitem"]'));t instanceof HTMLElement&&(e.composedPath().find(e=>e instanceof HTMLElement&&e.closest("summary"))||("ArrowUp"===e.key?(e.preventDefault(),this.handleArrowUp(t)):"ArrowDown"===e.key&&(e.preventDefault(),this.handleArrowDown(t))))}handleArrowUp(e){let t=this.menuItemElements.indexOf(e);if(-1===t)return;let n=this.menuItemElements[t-1]||this.menuItemElements[this.menuItemElements.length-1];n instanceof HTMLElement&&this.focusElement(n)}handleArrowDown(e){let t=this.menuItemElements.indexOf(e),n=this.menuItemElements[t+1]||this.menuItemElements[0];n instanceof HTMLElement&&this.focusElement(n)}handleToggle(){this.detailsElement.open&&this.positionPopover()}focusElement(e){if(e.focus(),!e.contains(window.document.activeElement)){let t=e.querySelector(':is(button, summary, [href], input, select, textarea, [tabindex]):not([tabindex="-1"]):not([type="hidden"]):not([disabled]):not([readonly])');t instanceof HTMLElement&&t.focus()}}handleFocusout(e){if(!(e instanceof FocusEvent)||!this.detailsElement.open)return;let{relatedTarget:t}=e;t instanceof HTMLElement&&(this===t||this.contains(t)||(this.detailsElement.open=!1))}}window.customElements.define("flyout-menu",E);let f='[role="gridcell"], [role="columnheader"], [role="rowheader"]',g=`[data-selectable]:is(${f})`,b=':is(:is(auto-save-search, auto-save-text) input, input[type="checkbox"])';function p(e){return e instanceof Element&&e.closest('flyout-menu [role="menu"]') instanceof HTMLElement}function y(e){return e instanceof HTMLElement}class C extends HTMLElement{constructor(){super();let e=this.querySelector('[role="grid"]');if(!(e instanceof HTMLElement))throw Error("Could not find grid element");this.gridElement=e}getClosestCellElementFromPoint(e){if(!(e instanceof PointerEvent))return this.getClosestCellElementFromComposedPath(e);{let t=null,n=window.document.elementFromPoint(e.clientX,e.clientY);return n instanceof HTMLElement&&(t=n.closest(f)),t}}getClosestCellElementFromComposedPath(e){let t=e.composedPath().find(e=>e instanceof HTMLElement&&e.matches(f));return t instanceof HTMLElement?t:null}updateHighlightElement(e,t,n){if(!e)return;let l=t.closest('[role="row"]');if(!(l instanceof HTMLElement))return;let i=n.closest('[role="row"]');if(!(i instanceof HTMLElement))return;let r=Array.from(l.querySelectorAll(f)).indexOf(t),o=Array.from(i.querySelectorAll(f)).indexOf(n),s=t.getBoundingClientRect().left,a=t.getBoundingClientRect().right,d=n.getBoundingClientRect().left,h=n.getBoundingClientRect().right,c=t.getBoundingClientRect().top,m=t.getBoundingClientRect().bottom,u=n.getBoundingClientRect().top,E=n.getBoundingClientRect().bottom,g=t===n,b=g?d:o<r&&!g?d:s,p=g?u:u<c&&!g?u:c;e.style.left=`${b}px`,e.style.top=`${p}px`,e.style.width=`${(g?h:o>r&&!g?h:a)-b}px`,e.style.height=`${(g?E:E>m&&!g?E:m)-p}px`,e.style.border="3px solid var(--swatch-interactive)"}initializeHighlightElement(e,t){if(e)return null;(e=window.document.createElement("div")).classList.add("highlight");let{left:n,top:l}=t.getBoundingClientRect();return e.style.top=`${l}px`,e.style.left=`${n}px`,this.appendChild(e),e}updateSelectedCells(e){if(!e)return;let{top:t,left:n,bottom:l,right:i}=e.getBoundingClientRect(),r=Array.from(this.gridElement.querySelectorAll(f)).filter(y),o=e=>{e.setAttribute("aria-selected","true")},s=e=>{e.removeAttribute("aria-selected")};for(let e of r){let r=e.getBoundingClientRect(),a=Math.ceil(r.top)>=Math.ceil(t),d=Math.ceil(r.bottom)<=Math.ceil(l),h=Math.ceil(r.left)>=Math.ceil(n),c=Math.ceil(r.right)<=Math.ceil(i);a&&d&&h&&c?o(e):s(e)}}selectCellElement(e){let{relativeCellElement:t,targetCellElement:n,originCellElement:l,highlightElement:i}=e,r=i,o=l;return i||(r=this.initializeHighlightElement(i,t),o=t),this.updateHighlightElement(r,n,o||t),this.updateSelectedCells(r),{highlightElement:r,originCellElement:o}}focusCellElement(e){if(e.focus(),!e.contains(window.document.activeElement)){let t=e.querySelector(':is(a, button, summary, [href], input, select, textarea, [tabindex]):not([tabindex="-1"]):not([type="hidden"]):not([disabled]):not([readonly])');t instanceof HTMLElement&&t.focus()}}removeHighlightElement(e,t){for(let e of Array.from(this.gridElement.querySelectorAll(g)))e.removeAttribute("aria-selected"),e.removeAttribute("data-selected");if(e&&t)return this.updateHighlightElement(e,t,t),this.updateSelectedCells(e),e.remove(),{highlightElement:null,originCellElement:null,lastSelectedCellElement:null}}clearCellSelection(){"dragHighlightElement"in this&&"dragOriginCellElement"in this&&(y(this.dragHighlightElement)||null===this.dragHighlightElement)&&(y(this.dragOriginCellElement)||null===this.dragOriginCellElement)&&Object.assign(this,this.removeHighlightElement(this.dragHighlightElement,this.dragOriginCellElement)),"keyboardHighlightElement"in this&&"keyboardOriginCellElement"in this&&(y(this.keyboardHighlightElement)||null===this.keyboardHighlightElement)&&(y(this.keyboardOriginCellElement)||null===this.keyboardOriginCellElement)&&Object.assign(this,this.removeHighlightElement(this.keyboardHighlightElement,this.keyboardOriginCellElement))}clearRowSelection(){let e=this.querySelector('select-all-checkbox input[type="checkbox"]');if(!(e instanceof HTMLInputElement))return;let t=e.form;if(t instanceof HTMLFormElement&&void 0!==Object.fromEntries(new FormData(t).entries())["row[]"])for(let e of Array.from(t.elements).filter(function(e){return e instanceof HTMLInputElement&&"checkbox"===e.type&&"row[]"===e.name}))e.checked=!1}selectAllRows(){let e=this.querySelector('select-all-checkbox input[type="checkbox"]');if(!(e instanceof HTMLInputElement))return;let t=e.form;if(t instanceof HTMLFormElement)for(let e of Array.from(t.elements).filter(e=>e instanceof HTMLInputElement&&"checkbox"===e.type&&"row[]"===e.name))e.checked=!0}selectAllCells(){for(let e of Array.from(this.gridElement.querySelectorAll(g)))e.setAttribute("aria-selected","true"),e.setAttribute("data-selected","")}}function v(e){e.preventDefault()}function w(e){e instanceof KeyboardEvent&&!this.isDragShiftKeyPressed&&(this.isDragShiftKeyPressed="Shift"===e.key||e.shiftKey)}function H(e){if(e instanceof KeyboardEvent){for(let t of(this.isDragShiftKeyPressed=e.shiftKey,Array.from(this.gridElement.querySelectorAll(g))))t.hasAttribute("aria-selected")?t.setAttribute("data-selected",""):t.removeAttribute("data-selected");if(!this.isDragShiftKeyPressed)for(let e of(this.dragHighlightElement&&this.dragHighlightElement.remove(),this.dragHighlightElement=null,this.dragOriginCellElement=null,this.isDragging=!1,Array.from(this.gridElement.querySelectorAll(`[data-selected]:is(${f})`))))e.removeAttribute("data-selected")}}function k(e){if(!(e instanceof PointerEvent))return;let t=this.getClosestCellElementFromComposedPath(e);t&&(this.isPointerDown=!0,this.focusCellElement(t),t.matches(g)&&(this.clearRowSelection(),Object.assign(this,this.removeHighlightElement(this.dragHighlightElement,this.dragOriginCellElement)),this.dragHighlightElement=this.initializeHighlightElement(this.dragHighlightElement,t),this.dragOriginCellElement=t))}function L(e){if(!(e instanceof PointerEvent)||!this.isPointerDown)return;window.document.body.classList.add("prevent-scroll"),e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation();let t=this.getClosestCellElementFromPoint(e);t&&t.matches(g)&&this.dragOriginCellElement instanceof HTMLElement&&(this.isDragging=!0,this.updateHighlightElement(this.dragHighlightElement,t,this.dragOriginCellElement),this.lastDragSelectedCellElement=t,this.updateSelectedCells(this.dragHighlightElement))}function A(e){e instanceof PointerEvent&&(window.document.body.classList.remove("prevent-scroll"),this.isPointerDown=!1,this.isDragging=!1,e.stopImmediatePropagation(),e.stopPropagation(),this.getClosestCellElementFromPoint(e)&&(this.dragHighlightElement?.remove(),this.dragHighlightElement=null,this.dragOriginCellElement=null,this.lastDragSelectedCellElement&&this.lastDragSelectedCellElement!==this.dragOriginCellElement&&this.focusCellElement(this.lastDragSelectedCellElement),this.lastDragSelectedCellElement=null))}function S(e,t){e.preventDefault();let n=t.closest('[role="row"]');if(!n)return;let l=Array.from(n.children).indexOf(t),i=n.closest('[role="grid"]');if(!(i instanceof HTMLElement))return;let r=Array.from(i.querySelectorAll('[role="row"]')),o=r.indexOf(n),s=r[o+1];if(!(s instanceof HTMLElement))return;let a=Array.from(s.children),d=a[Math.min(a.length-1,l)];if(!(d instanceof HTMLElement)||this.isKeyboardShiftKeyPressed&&!d.matches(g)||(this.focusCellElement(d),!this.isKeyboardShiftKeyPressed||!t.matches(g)||!d.matches(g)))return;this.clearRowSelection();let h=this.selectCellElement({targetCellElement:d,relativeCellElement:t,originCellElement:this.keyboardOriginCellElement,highlightElement:this.keyboardHighlightElement});h&&(this.keyboardHighlightElement=h.highlightElement,this.keyboardOriginCellElement=h.originCellElement)}function T(e,t){e.preventDefault();let n=t.previousElementSibling;if(!(n instanceof HTMLElement)||this.isKeyboardShiftKeyPressed&&!n.matches(g)||(this.focusCellElement(n),!this.isKeyboardShiftKeyPressed||!t.matches(g)||!n.matches(g)))return;this.clearRowSelection();let l=this.selectCellElement({targetCellElement:n,relativeCellElement:t,originCellElement:this.keyboardOriginCellElement,highlightElement:this.keyboardHighlightElement});l&&(this.keyboardHighlightElement=l.highlightElement,this.keyboardOriginCellElement=l.originCellElement)}function M(e,t){e.preventDefault();let n=t.nextElementSibling;if(!(n instanceof HTMLElement)||this.isKeyboardShiftKeyPressed&&!n.matches(g)||(this.focusCellElement(n),!this.isKeyboardShiftKeyPressed||!t.matches(g)||!n.matches(g)))return;this.clearRowSelection();let l=this.selectCellElement({targetCellElement:n,relativeCellElement:t,originCellElement:this.keyboardOriginCellElement,highlightElement:this.keyboardHighlightElement});l&&(this.keyboardHighlightElement=l.highlightElement,this.keyboardOriginCellElement=l.originCellElement)}function x(e,t){e.preventDefault();let n=t.closest('[role="row"]');if(!n)return;let l=Array.from(n.children).indexOf(t),i=n.closest('[role="grid"]');if(!(i instanceof HTMLElement))return;let r=Array.from(i.querySelectorAll('[role="row"]')),o=r.indexOf(n),s=r[o-1];if(!(s instanceof HTMLElement))return;let a=Array.from(s.children),d=a[Math.min(a.length-1,l)];if(!(d instanceof HTMLElement)||this.isKeyboardShiftKeyPressed&&!d.matches(g)||(this.focusCellElement(d),!this.isKeyboardShiftKeyPressed||!t.matches(g)||!d.matches(g)))return;this.clearRowSelection();let h=this.selectCellElement({targetCellElement:d,relativeCellElement:t,originCellElement:this.keyboardOriginCellElement,highlightElement:this.keyboardHighlightElement});h&&(this.keyboardHighlightElement=h.highlightElement,this.keyboardOriginCellElement=h.originCellElement)}function D(e,t){let n=Array.from(this.querySelectorAll(`[aria-selected="true"]:is(${g})`));n.length&&this.dispatchEvent(new CustomEvent("view-container:clear-cells",{bubbles:!0,composed:!0,detail:n})),this.matches(':has(input[type="checkbox"][name="row[]"]:checked)')&&this.dispatchEvent(new CustomEvent("view-container:delete-rows",{bubbles:!0,composed:!0}))}function K(e,t){e.preventDefault();let n=t.closest('[role="grid"]');if(!(n instanceof HTMLElement))return;let l=Array.from(n.querySelectorAll('[role="row"]')),i=l[l.length-1];if(!(i instanceof HTMLElement))return;let r=Array.from(i.children),o=r[r.length-1];if(!(o instanceof HTMLElement)||(this.focusCellElement(o),!this.isKeyboardShiftKeyPressed||!t.matches(g)||!o.matches(g)))return;this.clearRowSelection();let s=this.selectCellElement({targetCellElement:o,relativeCellElement:t,originCellElement:this.keyboardOriginCellElement,highlightElement:this.keyboardHighlightElement});s&&(this.keyboardHighlightElement=s.highlightElement,this.keyboardOriginCellElement=s.originCellElement)}function P(e){e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),this.clearCellSelection(),this.clearRowSelection()}function O(e,t){e.preventDefault();let n=t.closest('[role="grid"]');if(!(n instanceof HTMLElement))return;let l=Array.from(n.querySelectorAll('[role="row"]'))[0];if(!(l instanceof HTMLElement))return;let i=Array.from(l.children)[0];if(!(i instanceof HTMLElement)||(this.focusCellElement(i),!this.isKeyboardShiftKeyPressed||!t.matches(g)||!i.matches(g)))return;this.clearRowSelection();let r=this.selectCellElement({targetCellElement:i,relativeCellElement:t,originCellElement:this.keyboardOriginCellElement,highlightElement:this.keyboardHighlightElement});r&&(this.keyboardHighlightElement=r.highlightElement,this.keyboardOriginCellElement=r.originCellElement)}function q(e){if(!(e instanceof KeyboardEvent)||e.composedPath().find(p))return;this.isKeyboardShiftKeyPressed="Shift"===e.key||e.shiftKey;let t=e.composedPath().find(e=>e instanceof HTMLElement&&e.matches(f));if(!(t instanceof HTMLElement))return;let n=t.matches(':has(auto-save-text input[type="text"]:not([data-read-only]))');if(n){this.clearCellSelection(),this.clearRowSelection();return}switch(e.key){case"Escape":this.handleEscape(e);break;case"ArrowUp":this.handleArrowUp(e,t);break;case"ArrowDown":this.handleArrowDown(e,t);break;case"ArrowLeft":this.handleArrowLeft(e,t);break;case"ArrowRight":this.handleArrowRight(e,t);break;case"Home":this.handleHome(e,t);break;case"End":this.handleEnd(e,t);break;case"a":e.ctrlKey&&(t.matches(g)&&!n&&(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),this.selectAllCells()),t.matches(':has([name="row[]"])')&&(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),this.selectAllRows()));break;case" ":this.handleSpacebar(e,t);break;case"Delete":case"Backspace":this.handleDelete(e,t)}}function I(e){e instanceof KeyboardEvent&&(this.isKeyboardShiftKeyPressed=e.shiftKey,this.isKeyboardShiftKeyPressed||(this.clearKeyboardHighlight(),this.sealKeyboardSelectedCells()))}function R(e,t){if(!this.isKeyboardShiftKeyPressed||!(t.querySelector(b) instanceof HTMLInputElement))return;e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),this.sealKeyboardSelectedCells();let n=this.selectCellElement({targetCellElement:t,relativeCellElement:t,originCellElement:this.keyboardOriginCellElement,highlightElement:this.keyboardHighlightElement});n&&(this.keyboardHighlightElement=n.highlightElement,this.keyboardOriginCellElement=n.originCellElement),this.clearKeyboardHighlight()}let F=class extends C{constructor(){super(...arguments),this.boundHandleAutoSaveTextSave=this.handleAutoSaveTextSave.bind(this),this.boundClearCellsHandler=this.handleClearCells.bind(this),this.boundHandleAutoSaveTextToggleEditMode=this.handleAutoSaveTextToggleEditMode.bind(this),this.boundHandleDeleteRows=this.handleDeleteRows.bind(this),this.boundChangeHandler=this.handleChange.bind(this)}connectedCallback(){this.addEventListener("view-container:clear-cells",this.boundClearCellsHandler,{capture:!0}),this.addEventListener("auto-save-text:save",this.boundHandleAutoSaveTextSave),this.addEventListener("auto-save-text:toggle-edit-mode",this.boundHandleAutoSaveTextToggleEditMode),this.addEventListener("view-container:delete-rows",this.boundHandleDeleteRows),this.addEventListener("change",this.boundChangeHandler),this.addEventListener("column-selector:select",e=>{if(!(e instanceof CustomEvent))return;let{detail:t}=e;if(!t)return;let n=this.getClosestCellElementFromComposedPath(e);if(!(n instanceof HTMLElement))return;let l=n.closest('[role="row"]');if(!(l instanceof HTMLElement))return;let i=Array.from(l.querySelectorAll(f)).indexOf(n),r=Array.from(this.querySelectorAll('[role="row"]:not(:has([role="columnheader"]))')).filter(y),o=r[0],s=r[r.length-1],a=Array.from(o.querySelectorAll(f))[i];if(!(a instanceof HTMLElement))return;let d=Array.from(s.querySelectorAll(f))[i];if(!(d instanceof HTMLElement))return;let h=Array.from(this.querySelectorAll(`[aria-selected]:is(${g})`)).filter(y);if(this.clearRowSelection(),this.clearCellSelection(),"keyboardHighlightElement"in this&&"keyboardOriginCellElement"in this){let e=this.selectCellElement({targetCellElement:d,relativeCellElement:a,originCellElement:a,highlightElement:null});this.keyboardOriginCellElement=a,e&&(this.keyboardHighlightElement=e.highlightElement,this.keyboardOriginCellElement=e.originCellElement);let t=Array.from(this.querySelectorAll(`[aria-selected]:is(${g})`)).filter(y);for(let e of(y(this.keyboardHighlightElement)&&y(this.keyboardOriginCellElement)&&this.removeHighlightElement(this.keyboardHighlightElement,this.keyboardOriginCellElement),[...h,...t]))e.setAttribute("aria-selected","true")}})}disconnectedCallback(){this.removeEventListener("view-container:clear-cells",this.boundClearCellsHandler,{capture:!0}),this.removeEventListener("auto-save-text:save",this.boundHandleAutoSaveTextSave),this.removeEventListener("auto-save-text:toggle-edit-mode",this.boundHandleAutoSaveTextToggleEditMode),this.removeEventListener("view-container:delete-rows",this.boundHandleDeleteRows),this.removeEventListener("change",this.boundChangeHandler)}handleAutoSaveTextSave(e){if(!(e instanceof CustomEvent))return;let{target:t}=e;if(!(t instanceof HTMLElement))return;let n=t.querySelector(b);if(!(n instanceof HTMLInputElement))return;let l=t.closest('[role="row"]');if(!(l instanceof HTMLElement))return;let i=Array.from(this.gridElement.querySelectorAll('[role="row"]'));if(Number(i.indexOf(l))!==i.length-1)return;let r=this.querySelector("#add-new-row-button");if(!(r instanceof HTMLButtonElement))throw Error("Could not find add new row button element");let o=r.form;if(!(o instanceof HTMLFormElement))throw Error("Could not find add new row form element");let s=document.createElement("input");s.setAttribute("type","hidden"),s.setAttribute("name","_autofocus"),s.setAttribute("value",n.id),o.append(s),o.submit(),s.remove()}handleClearCells(e){if(!(e instanceof CustomEvent)||!Array.isArray(e.detail))return;let t=e.detail.filter(y);for(let e of t){let t=e.querySelector(b);t instanceof HTMLInputElement&&(t.value="")}let n=this.querySelector("#clear-cells-button");if(!(n instanceof HTMLButtonElement))throw Error("Could not find clear cells button element");let l=n.form;if(!(l instanceof HTMLFormElement))throw Error("Could not find add new row form element");let i=l.querySelector('input[type="hidden"][name="cell[]"]');if(!(i instanceof HTMLInputElement))throw Error("Could not find hidden input element");let r=t.map(e=>{let t=e.getAttribute("data-row-id");if(!t)throw Error("Could not find id attribute");let n=e.getAttribute("data-property-id");if(!n)throw Error("Could not find id attribute");return t+":"+n}).join(",");i.setAttribute("value",r),fetch(l.action,{method:l.method,body:new FormData(l)})}handleAutoSaveTextToggleEditMode(e){if(!(e instanceof CustomEvent)||!(e.target instanceof HTMLElement))return;let t=e.target.closest(f);if(!(t instanceof HTMLElement))return;let n=t.closest('[role="row"]');if(!(n instanceof HTMLElement))return;let l=Array.from(n.children).indexOf(t),i=Array.from(this.gridElement.querySelectorAll('[role="row"]')),r=i.indexOf(n),o=i[r+1];if(!(o instanceof HTMLElement))return;let s=o.children[l];s instanceof HTMLElement&&this.focusCellElement(s)}handleDeleteRows(){let e=this.querySelector('select-all-checkbox input[type="checkbox"]');if(!(e instanceof HTMLInputElement))return;let t=e.form;if(!(t instanceof HTMLFormElement)||void 0===Object.fromEntries(new FormData(t).entries())["row[]"])return;let n=this.querySelector("#select-multiple-rows-form");if(!(n instanceof HTMLFormElement))return;let l=n.querySelector('[name="bulkAction"]');l instanceof HTMLSelectElement&&(l.value="DELETE",n.submit())}handleChange(e){let t=this.getClosestCellElementFromComposedPath(e);t instanceof HTMLElement&&t.matches(':has(input[name="row[]"])')&&t.querySelector('input[name="row[]"]') instanceof HTMLInputElement&&this.clearCellSelection()}};F=function(e,t,n,l){var i,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,n):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,l);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}([function(e){return class extends e{constructor(){super(...arguments),this.isDragShiftKeyPressed=!1,this.isPointerDown=!1,this.isDragging=!1,this.lastDragSelectedCellElement=null,this.dragOriginCellElement=null,this.dragHighlightElement=null,this.pointerId=0,this.boundPointerdownHandler=k.bind(this),this.boundPointermoveHandler=L.bind(this),this.boundPointerupHandler=A.bind(this),this.boundDragKeydownHandler=w.bind(this),this.boundDragKeyupHandler=H.bind(this),this.boundDragstartHandler=v.bind(this)}connectedCallback(){e.prototype.connectedCallback&&e.prototype.connectedCallback.call(this),this.addEventListener("pointerdown",this.boundPointerdownHandler),this.addEventListener("pointermove",this.boundPointermoveHandler),this.addEventListener("pointerup",this.boundPointerupHandler,{capture:!0}),this.addEventListener("pointercancel",this.boundPointerupHandler,{capture:!0}),this.addEventListener("keydown",this.boundDragKeydownHandler),this.addEventListener("keyup",this.boundDragKeyupHandler),this.addEventListener("dragstart",this.boundDragstartHandler)}disconnectedCallback(){e.prototype.disconnectedCallback&&e.prototype.disconnectedCallback.call(this),this.removeEventListener("pointerdown",this.boundPointerdownHandler),this.removeEventListener("pointermove",this.boundPointermoveHandler),this.removeEventListener("pointerup",this.boundPointerupHandler,{capture:!0}),this.removeEventListener("pointercancel",this.boundPointerupHandler,{capture:!0}),this.removeEventListener("keydown",this.boundDragKeydownHandler),this.removeEventListener("keyup",this.boundDragKeyupHandler),this.removeEventListener("dragstart",this.boundDragstartHandler)}}},function(e){return class extends e{constructor(){super(...arguments),this.isKeyboardShiftKeyPressed=!1,this.keyboardOriginCellElement=null,this.keyboardHighlightElement=null,this.handleKeydown=q.bind(this),this.handleKeyup=I.bind(this),this.handleArrowUp=x.bind(this),this.handleArrowDown=S.bind(this),this.handleArrowLeft=T.bind(this),this.handleArrowRight=M.bind(this),this.handleHome=O.bind(this),this.handleEnd=K.bind(this),this.handleEscape=P.bind(this),this.handleSpacebar=R.bind(this),this.handleDelete=D.bind(this)}connectedCallback(){e.prototype.connectedCallback&&e.prototype.connectedCallback.call(this),this.addEventListener("keydown",this.handleKeydown,{capture:!0}),this.addEventListener("keyup",this.handleKeyup)}disconnectedCallback(){e.prototype.disconnectedCallback&&e.prototype.disconnectedCallback.call(this),this.removeEventListener("keydown",this.handleKeydown,{capture:!0}),this.removeEventListener("keyup",this.handleKeyup)}sealKeyboardSelectedCells(){for(let e of Array.from(this.gridElement.querySelectorAll(g)))e.hasAttribute("aria-selected")?e.setAttribute("data-selected",""):e.removeAttribute("data-selected")}clearKeyboardHighlight(){this.keyboardHighlightElement&&this.keyboardHighlightElement.remove(),this.keyboardHighlightElement=null,this.keyboardOriginCellElement=null}}}],F),window.customElements.define("view-container",F);class B extends HTMLElement{constructor(){super(...arguments),this.boundClickHandler=this.handleClick.bind(this),this.boundKeydownHandler=this.handleKeydown.bind(this)}connectedCallback(){this.addEventListener("click",this.boundClickHandler),this.addEventListener("keydown",this.boundKeydownHandler)}disconnectedCallback(){this.removeEventListener("click",this.boundClickHandler),this.removeEventListener("keydown",this.boundKeydownHandler)}handleClick(){let e=this.getAttribute("data-href");null!==e&&(window.location.href=e)}handleKeydown(e){e instanceof KeyboardEvent&&"Enter"===e.key&&(e.preventDefault(),this.handleClick())}}window.customElements.define("hyper-link",B);let U=':is(button, [href], input, select, textarea):not([type="hidden"]):not([disabled]):not([readonly])';class $ extends HTMLElement{constructor(){super(),this.boundToggleHandler=this.handleToggle.bind(this);let e=this.querySelector("details");if(!(e instanceof HTMLDetailsElement))throw Error("Could not find details element");this.detailsElement=e}connectedCallback(){this.detailsElement.addEventListener("toggle",this.boundToggleHandler)}disconnectedCallback(){this.detailsElement.removeEventListener("toggle",this.boundToggleHandler)}handleToggle(){let e=Array.from(new Set([...Array.from(this.detailsElement.querySelectorAll("*:not(summary)")).filter(e=>e.shadowRoot&&e.shadowRoot.delegatesFocus),...Array.from(this.detailsElement.querySelectorAll(U))]));if(this.detailsElement.open){for(let t of e)t.removeAttribute("tabindex");let[t]=e;if(!(t instanceof HTMLElement))return;this.focusElement(t)}else for(let t of e)t.setAttribute("tabindex","-1")}focusElement(e){if(e.focus(),!e.contains(window.document.activeElement)){let t=e.querySelector(U);t instanceof HTMLElement&&t.focus()}}}window.customElements.define("disclosure-widget",$);class N extends HTMLElement{constructor(){super(),this.boundClickHandler=this.handleClick.bind(this);let e=this.querySelector("button");if(!(e instanceof HTMLElement))throw Error("No button element provided");this.buttonElement=e}connectedCallback(){this.buttonElement.addEventListener("click",this.boundClickHandler)}disconnectedCallback(){this.buttonElement.removeEventListener("click",this.boundClickHandler)}handleClick(){let e=this.getAttribute("data-property");e&&(this.dispatchEvent(new CustomEvent("column-selector:select",{bubbles:!0,composed:!0,detail:e})),this.dispatchEvent(new KeyboardEvent("keydown",{bubbles:!0,composed:!0,key:"Escape"})))}}window.customElements.define("column-selector",N)})();
//# sourceMappingURL=client.js.map
